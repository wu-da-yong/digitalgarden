---
{"dg-publish":true,"permalink":"/Zettelkasten/15b1g6 计量经济学中的因果与因果推断/","dgPassFrontmatter":true}
---

编号:: 15b1g6
标题:: 计量经济学中的因果与因果推断
创建时间:: 2023-08-09 16:36
up:: [[Zettelkasten/15b1g 经济学原理\|15b1g 经济学原理]]
来源:: 

---

本文旨在广泛介绍在自动因果推断（automated causal inference ）和一些涌现出来的新的方法如i.i.d 数据和时间序列的核心概念和基本原则。在介绍完操作方法、因果模型、抽样预测模型、因果预测模型和结构方程模型后，我们会介绍**基于约束方法（constraint-based approach）**去做因果识别，它依赖于数据独立关系的条件，并讨论其假设的有效性。随后我们把目光转向**结构方程模型（structural equations models，SEM）**，它的核心在于良定义**结构方程模型中因果结构**的**可识别性（identifiability ）**：如在两个变量的情况下，在什么条件下（以及为什么）两个变量间的因果趋势是可以识别的。我们说明了误差项与因果间的独立性和结构方程的结构约束是如何可能的。接下来，我们将要汇报关于时间序列因果发现的一些最新进展。我们假设**因果关系（causal relation）**是线性的，且噪声是非高斯分布的。我们会提到两个历史性难题——即从**下抽样数据（subsampled data ）**和**混杂时间序列（confounding time series）**中发现的因果关系。最后我给出因果推断和识别领域的开放性问题清单。

## Keywords：

Causal inference ；Causal discovery； Structural equation model； Conditional independence ；Statistical independence； Identifiability

---

## 译者注：

1.**Constraint-based approach**：此方法的思想主要在于判断变量之间的独立性，所以会涉及一系列判断条件独立的方法。如偏相关系数、互信息、贝叶斯理论。

2.**Confounding**：某些因素（confounder）和暴露因素(exposure) 以及事件outcome同时有关联，对exposure和outcome的真实关系造成的影响。并且，此因素不应起中介作用（不是mediator） 。

3.假设有一个具有不确定性的**过程（process）**，然后这个过程可以随机的产生不同的**结果（outcomes）**。该过程的**概率模型**对我们来说是**未知**的，但是我们有一系列该过程产生的结果的**观测值**；我们希望通过这些观测值来推断出这个过程中的不确定性是什么样的。

那么计量经济学的研究问题或现象的范式大概如下

![](https://picx.zhimg.com/v2-a43e39ca8a510ff51a5f5684e9eec6e9_720w.jpg?source=d16d100b)

但计量经济学常常遇到这样的问题： 理论常常并不足以限定数据生成过程，对于非常精确的理论很容易进行检验。然而许多经济理论并不精确，无法准确说明经济行为模式，常常出现不同的理论都与观察到的现象相一致。

在进行政策分析和预测时，我们常常以既不精确、也不可靠的理论为基础，试图发现数据生成过程。此时会出现所谓的**“数据挖掘” (data-mining)**问题。  

而偏好单纯依据模型估计结果的统计表现作为选择标准 ，如使用纯粹基于统计学的估计技术 ，如Stepwise regression 、 Principal components 。 此时容易出现虚假回归(伪回归)错误 (Spurious regression)  
  

4.**如何定义因果？**研究现象，社会科学一般都会建立模型分析，然后通过数据去验证模型的结论。模型只是对于现实现象的**一种逻辑解释**，或者说**统计模型是一系列简化事实的分布**，而数据则是源自现象本身。但是社会科学领域的因果与哲学领域定义的因果不一样，或者说关注点不同。
https://plato.stanford.edu/entries/causation-metaphysics/

我的理解，在计量经济学中偏向于Rubin，也就是把它理解为**处理效应（ treatment effects ）**，因果关系的分析一定要有行动施加于个体。给定个体和一个行动集，我们给每个行动和个体的搭配赋予一个变量，这个变量叫做潜在结果(potential outcomes)。事后来看，只有一种潜在结果可以被观察到。进行因果分析所面临的最根本的问题：就是一个缺失数据的问题。因此要进行因果分析，就需要把缺失的潜在结果填补上。一些个体的背景特征（协变量）往往能够帮助我们进行缺失潜在结果的预测。

我一直认为**回归**是因果分析最有效的工具。

我们不妨想象一件事，我们把健身描述为一个二值随机变量 ，Di={0，1}D_{i}=\left\{ 0，1 \right\} .然后我们的研究结果是人的健康水平，用一个量度量即 YiY_{i} 。

那么对于任何个体来说，都有两个潜在结果

101^{0} ，Y1i，ifDi=1Y_{1i}，if D_{i}=1

，20Y0i，ifDi=02^{0}Y_{0i}，ifD_{i}=0

观察到的结果可以用潜在结果的线性组合表示， （）Yi=Y0i+（Y1i−Y0i）DiY_{i}=Y_{0i}+（Y_{1i}-Y_{0i}）D_{i} （公式1）

此式子中 （）（Y1i−Y0i）（Y_{1i}-Y_{0i}） 就是个体去健身对其健康状况的影响。

那么下面这个式子就表达了去健身与否带来的对平均健康水平的差异，与我们所说的平均意义上的因果效应的关系：

E[Yi|Di=1]−E[Yi|Di=0]=E[Y1i|Di=1]−E[Y0i|Di=1]+E[Y0i|Di=1]−E[Y0i|Di=0]E\left[ Y_{i} |D_{i}=1\right]-E\left[ Y_{i} |D_{i}=0\right]=E\left[ Y_{1i} |D_{i}=1\right]-E\left[ Y_{0i} |D_{i}=1\right]+E\left[ Y_{0i} |D_{i}=1\right]-E\left[ Y_{0i} |D_{i}=0\right]

也就是处理的平均效应+选择性偏误，其中

E[Y1i|Di=1]−E[Y0i|Di=1]=E[Y1i−Y0i|Di=1]E\left[ Y_{1i} |D_{i}=1\right]-E\left[ Y_{0i} |D_{i}=1\right]=E\left[ Y_{1i} -Y_{0i}|D_{i}=1\right]

也就是说我们能观察到的健康水差异分为两部分，一部分是与健身的因果关系，一部分是选择性偏误，因此经济学家要剔除选择性偏误，从而阐释某个变量带来的因果效果。换言之想要从数据中找到控制变量和响应变量的指向性关系，往往要把数据和模型中存在的干扰过滤干净。

在经典计量分析在，选择性偏误包含两种：1）是样本选择偏误，2）自选择问题，也就是treatment是否严格外生（政策、法律、法规、制度安排）。

处理样本选择偏误一般使用Heckman两步法，在存在自选择问题时，一般使用PSM和DID等方法。

再回到因果效应。

我们可以假设因果效应对所有人都一样，是 Y1i−Y0i=ρY_{1i}-Y_{0i}=\rho ，是一个常数。

我们带入（公式1）

得到： Yi=α+ρDi+ηiY_{i}=\alpha+\rho D_{i}+\eta_{i}

其中： α=E(Y0i)\alpha=E\left( Y_{0i} \right) ； ηi=Y0i−E(Y0i)\eta_{i}=Y_{0i}-E\left( Y_{0i} \right) 也就是 Y0iY_{0i} 的随即部分

对上式求条件期望得：

E[Yi|Di=1]=α+ρ+E[ηi|Di=1]E\left[ Y_{i} |D_{i}=1\right]=\alpha+\rho+E\left[ \eta_{i} |D_{i}=1\right]

E[Yi|Di=0]=α+ρ+E[ηi|Di=0]E\left[ Y_{i} |D_{i}=0\right]=\alpha+\rho+E\left[ \eta_{i} |D_{i}=0\right]

于是： E[Yi|Di=1]−E[Yi|Di=0]=ρ+E[ηi|Di=1]−E[ηi|Di=0]E\left[ Y_{i} |D_{i}=1\right]-E\left[ Y_{i} |D_{i}=0\right]=\rho+E\left[ \eta_{i} |D_{i}=1\right]-E\left[ \eta_{i} |D_{i}=0\right]

因此选择性偏误则意味着回归残差项 ηi\eta_{i} 与回归元 DiD_{i} 之间的相关性

我们说被解释变量Y的条件期望 ( | )随解释变量 x的变化而有规律的变化，如果把y的条件期望表示为x 的某种函数 ( | )= ( ) ，这个函数是回归函数。似乎计量经济学研究中“计量”的一个重要目的就是要寻求体回归函数 。有了这个函数，我们才能清晰的看见被解释变量和解释变量间的依赖关系 。这也就是在说回归是在做什么。

可以是有人就想问了，**回归和因果是什么关系？何时可对回归赋予一个因果解释? 何时可将回归系数看作对原本只在随机实验以出现的因果效应的近似?**

我敲不动字了，详见Joshua Angrist 和 Jörn-Steffen Pischke 所著的_Mostly Harmless Econometrics_的第一部分，3.2节。

5.社会科学的因果推断方法

我认为这个分法比较好

经济学中主要有五种 approach：

- **多元线性回归**（multiple linear regression）
- **机器学习**（machine learning）
- **Rubin 因果模型**（Rubin's casual models）
- **结构模型**（structural models）
- **充分统计量**（sufficient statistics）

“Does Regression Produce Representative Estimates of Causal Effects?,” P. Aronow & C. Samii (2016) by Kevin Bryan on February 26, 2016  
  

[目前社会科学经验研究中「因果识别」都有哪些方法和新发展？60 赞同 · 6 评论回答![](https://picx.zhimg.com/1276b7ac7719f8246cf7a852aedab757_180x120.jpg?source=d16d100b)](https://www.zhihu.com/question/27516929/answer/37763695)

6.关于方法的一些吐槽

今年诺奖的**随机试验（RCT - Random Control Trial ），**但这个模型最大的问题是结果不可扩展或者推广（external validity），而且烧钱。

我本科时候，一门课写了个小论文，当时用了工具变量（IV）的方法

计量史学貌似很爱双重差分（DID）

我本科上**社会学课**的时候，我的教授和我说她们当时倾向值匹配（PSM）和断点回归（RD）玩的很凶。